import{d as V,u as w,r as p,c as m,w as t,b as a,o as I,e,q as x,v as B,D as K,s as Q,i,y as D,f as u,z as g,E as k,F as b,G as T,t as f,R as N,A as M,I as q,g as _,h as v,l as F,j as L,J as O,P,n as h,p as A,K as y,Q as H}from"./index-32020cdc.js";import{Q as $}from"./QRScannerMobile-c49c0d7d.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-982fae57.js";const z={class:"content-container"},E=V({__name:"ValidasiKotor",setup(G){const C=w(),s=p(null),o=p(!1),r=p(""),R=async d=>{var l,n;try{o.value=!0;const c=await y.post("/transactions/scan-transaction",{qr_content:d});if(c.data.data.transaction.type!=="kotor"){r.value="QR ini bukan transaksi kotor",s.value=null;return}s.value=c.data.data.transaction}catch(c){r.value=((n=(l=c.response)==null?void 0:l.data)==null?void 0:n.message)||"Failed to scan QR code"}finally{o.value=!1}},S=async()=>{var d,l;try{o.value=!0,await y.post("/transactions/validate",{qr_content:`TRANS:${s.value.uuid}`}),await(await H.create({header:"Sukses",message:"Transaksi kotor berhasil divalidasi",buttons:[{text:"OK",handler:()=>{C.push("/home")}}]})).present()}catch(n){r.value=((l=(d=n.response)==null?void 0:d.data)==null?void 0:l.message)||"Failed to validate transaction"}finally{o.value=!1}};return(d,l)=>(I(),m(a(A),null,{default:t(()=>[e(a(D),null,{default:t(()=>[e(a(x),null,{default:t(()=>[e(a(B),{slot:"start"},{default:t(()=>[e(a(K),{"default-href":"/home"})]),_:1}),e(a(Q),null,{default:t(()=>[...l[1]||(l[1]=[i("Validasi Transaksi Kotor",-1)])]),_:1})]),_:1})]),_:1}),e(a(h),{fullscreen:!0},{default:t(()=>[u("div",z,[e(a(g),null,{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(b),null,{default:t(()=>[...l[2]||(l[2]=[i("Scan QR Transaksi Kotor",-1)])]),_:1}),e(a(T),null,{default:t(()=>[...l[3]||(l[3]=[i("Scan QR code untuk validasi pengambilan kotor",-1)])]),_:1})]),_:1})]),_:1}),e($,{onScan:R}),s.value?(I(),m(a(g),{key:0},{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(b),null,{default:t(()=>[i("Transaksi #"+f(s.value.id),1)]),_:1}),e(a(T),null,{default:t(()=>[e(a(N),{color:"warning"},{default:t(()=>[...l[4]||(l[4]=[i("KOTOR",-1)])]),_:1})]),_:1})]),_:1}),e(a(M),null,{default:t(()=>[e(a(q),null,{default:t(()=>[e(a(_),null,{default:t(()=>[e(a(v),null,{default:t(()=>{var n;return[l[5]||(l[5]=u("p",null,"Unit",-1)),u("h3",null,f((n=s.value.unit)==null?void 0:n.name),1)]}),_:1})]),_:1}),e(a(_),null,{default:t(()=>[e(a(v),null,{default:t(()=>{var n;return[l[6]||(l[6]=u("p",null,"Dibuat oleh",-1)),u("h3",null,f((n=s.value.creator)==null?void 0:n.name),1)]}),_:1})]),_:1}),e(a(_),null,{default:t(()=>[e(a(v),null,{default:t(()=>[l[7]||(l[7]=u("p",null,"Total Items",-1)),u("h3",null,f(s.value.total_items),1)]),_:1})]),_:1})]),_:1}),e(a(F),{expand:"block",color:"warning",onClick:S,disabled:o.value,class:"validate-button"},{default:t(()=>[i(f(o.value?"Memvalidasi...":"Validasi Pengambilan"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})):L("",!0)]),e(a(O),{"is-open":!!r.value,message:r.value,duration:3e3,color:"danger",onDidDismiss:l[0]||(l[0]=n=>r.value="")},null,8,["is-open","message"]),e(a(P),{"is-open":o.value,message:"Memproses..."},null,8,["is-open"])]),_:1})]),_:1}))}});const Y=j(E,[["__scopeId","data-v-63ba63c5"]]);export{Y as default};
